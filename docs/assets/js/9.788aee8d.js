(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{365:function(e,o,t){"use strict";t.r(o);var a=t(45),r=Object(a.a)({},(function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"ci-cd-basic"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ci-cd-basic"}},[e._v("#")]),e._v(" CI/CD Basic")]),e._v(" "),t("p",[e._v("This document explains basic about "),t("code",[e._v("./cicd")]),e._v(".")]),e._v(" "),t("p",[e._v("This module is the main implementation of "),t("code",[e._v("CI/CD on k8s")]),e._v(".")]),e._v(" "),t("h2",{attrs:{id:"how-it-works"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-it-works"}},[e._v("#")]),e._v(" How it works?")]),e._v(" "),t("p",[e._v("The built-in CI/CD utilize these projects:")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/argoproj/argo-workflows",target:"_blank",rel:"noopener noreferrer"}},[e._v("Argo Workflows"),t("OutboundLink")],1),e._v(": Construct CI/CD pipelines/workflows")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/argoproj/argo-cd",target:"_blank",rel:"noopener noreferrer"}},[e._v("Argo CD"),t("OutboundLink")],1),e._v(": Provide CD + gitops implementation. Detect change of git repository and deploy.")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/argoproj/argo-events",target:"_blank",rel:"noopener noreferrer"}},[e._v("Argo Events"),t("OutboundLink")],1),e._v(": Listen to various events and trigger various actions including "),t("code",[e._v("Argo Workflows")]),e._v(".")]),e._v(" "),t("li",[e._v("[TODO]: chatops implementation")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://min.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("MinIO"),t("OutboundLink")],1),e._v(": Provide artifact repostiory capability for CI/CD.")])]),e._v(" "),t("h2",{attrs:{id:"deploy-undeploy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploy-undeploy"}},[e._v("#")]),e._v(" Deploy/Undeploy")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("make")]),e._v(" deploy\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Undeploy:")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("make")]),e._v(" undeploy\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h2",{attrs:{id:"how-to-use-ci-with-argo-workflows"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-ci-with-argo-workflows"}},[e._v("#")]),e._v(" How to Use CI with Argo Workflows?")]),e._v(" "),t("p",[e._v("This section introduce basic CI usage with built-in "),t("code",[e._v("Argo Workflows")]),e._v(".")]),e._v(" "),t("p",[e._v("To know more, please check "),t("a",{attrs:{href:"https://argoproj.github.io/argo-workflows/",target:"_blank",rel:"noopener noreferrer"}},[e._v("official documents"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("h3",{attrs:{id:"modify-the-configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#modify-the-configuration"}},[e._v("#")]),e._v(" Modify the Configuration")]),e._v(" "),t("p",[e._v("First, specify a host like "),t("code",[e._v("argo.cicd.localhost")]),e._v(" for the web server of "),t("code",[e._v("Argow Workflows")]),e._v(".")]),e._v(" "),t("p",[e._v("Modify it through modify "),t("code",[e._v("/spec/rules/0/host")]),e._v(" in "),t("code",[e._v("./cicd/kustomize/argo-workflows/local/ingress.yaml")]),e._v(".")]),e._v(" "),t("p",[e._v("If you are deploying the cicd in local k8s cluster, you will need to be able to resolve DNS for *.localhost.\nYou can check "),t("code",[e._v("./local-k8s-cluster/scripts/override_dns.sh")]),e._v(" as a tip.")]),e._v(" "),t("p",[e._v("Also specify "),t("code",[e._v("namespace")]),e._v(" in "),t("code",[e._v("./cicd/kustomize/kustomization.yaml")]),e._v(" and "),t("code",[e._v("./cicd/kustomize/namespace.yaml")]),e._v(".\nDefault is "),t("code",[e._v("cicd")]),e._v(".")]),e._v(" "),t("h3",{attrs:{id:"after-deploy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#after-deploy"}},[e._v("#")]),e._v(" After Deploy")]),e._v(" "),t("p",[e._v("After deploy, you can check "),t("code",[e._v("Argo Workflow Server")]),e._v(" Web UI from "),t("a",{attrs:{href:"http://argo.cicd.localhost",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://argo.cicd.localhost"),t("OutboundLink")],1),e._v(" or the host you specify.")]),e._v(" "),t("p",[e._v("You can check "),t("code",[e._v("Argo CD")]),e._v(" Web UI from "),t("a",{attrs:{href:"http://argocd.cicd.localhost",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://argocd.cicd.localhost"),t("OutboundLink")],1),e._v(" or the host you specify.")]),e._v(" "),t("p",[e._v("You can check "),t("code",[e._v("MinIO")]),e._v(" Web UI from "),t("a",{attrs:{href:"http://minio.cicd.localhost",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://minio.cicd.localhost"),t("OutboundLink")],1),e._v(" or the host you specify.")]),e._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),t("p",[e._v("As current testing, "),t("code",[e._v("Argo Server")]),e._v(" Web UI may not support Microsoft Edge yet.")])]),e._v(" "),t("h3",{attrs:{id:"deploy-a-hello-world-workflow"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploy-a-hello-world-workflow"}},[e._v("#")]),e._v(" Deploy a Hello-World Workflow")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("kubectl --namespace cicd create -f ./cicd/manefest/argo-workflow-test.yaml\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Then an Argo "),t("code",[e._v("Workflow")]),e._v(" Resource with the name "),t("code",[e._v("hello-world-xxx")]),e._v(" will be deploy, bringing up a pod with the same name.")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("kubectl --namespace cicd logs hello-world-xxx -c main\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("This command will show the execution result in the log.")]),e._v(" "),t("p",[e._v("To delete this workflow, simply")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("kubectl --namespace cicd delete workflow hello-world-xxx\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h3",{attrs:{id:"argo-workflows-catalog"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#argo-workflows-catalog"}},[e._v("#")]),e._v(" Argo Workflows Catalog")]),e._v(" "),t("p",[e._v("For more reusable "),t("code",[e._v("Argo Workflow Template")]),e._v(", please check "),t("a",{attrs:{href:"https://argoproj-labs.github.io/argo-workflows-catalog/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Argo Workflows Catalog"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("h2",{attrs:{id:"how-to-use-cd-with-argo-cd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-cd-with-argo-cd"}},[e._v("#")]),e._v(" How to Use CD with Argo CD?")]),e._v(" "),t("p",[e._v("This section introduce basic CI usage with built-in "),t("code",[e._v("Argo CD")]),e._v(".")]),e._v(" "),t("p",[e._v("To know more, please check "),t("a",{attrs:{href:"https://argo-cd.readthedocs.io/en/stable/",target:"_blank",rel:"noopener noreferrer"}},[e._v("official documents"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("h3",{attrs:{id:"modify-the-configuration-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#modify-the-configuration-2"}},[e._v("#")]),e._v(" Modify the Configuration")]),e._v(" "),t("p",[e._v("First, specify a host like "),t("code",[e._v("argocd.cicd.localhost")]),e._v(" for the web server of "),t("code",[e._v("Argow CD")]),e._v(".")]),e._v(" "),t("p",[e._v("Modify it through modify "),t("code",[e._v("/spec/rules/0/host")]),e._v(" in "),t("code",[e._v("./cicd/kustomize/argo-cd/local/ingress.yaml")]),e._v(".")]),e._v(" "),t("p",[e._v("If you are deploying the cicd in local k8s cluster, you will need to be able to resolve DNS for *.localhost.\nYou can check "),t("code",[e._v("./local-k8s-cluster/scripts/override_dns.sh")]),e._v(" as a tip.")]),e._v(" "),t("p",[e._v("Also specify "),t("code",[e._v("namespace")]),e._v(" in "),t("code",[e._v("./cicd/kustomize/kustomization.yaml")]),e._v(" and "),t("code",[e._v("./cicd/kustomize/namespace.yaml")]),e._v(".\nDefault is "),t("code",[e._v("cicd")]),e._v(".")]),e._v(" "),t("h3",{attrs:{id:"after-deploy-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#after-deploy-2"}},[e._v("#")]),e._v(" After Deploy")]),e._v(" "),t("p",[e._v("After deploy, you can check "),t("code",[e._v("Argo CD Server")]),e._v(" Web UI from "),t("a",{attrs:{href:"http://argocd.cicd.localhost",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://argocd.cicd.localhost"),t("OutboundLink")],1),e._v(" or the host you specify.")]),e._v(" "),t("p",[e._v("You can check the initial "),t("code",[e._v("username")]),e._v(" & "),t("code",[e._v("password")]),e._v(" by following the "),t("a",{attrs:{href:"https://argo-cd.readthedocs.io/en/stable/getting_started/#4-login-using-the-cli",target:"_blank",rel:"noopener noreferrer"}},[e._v("official documents"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"deploy-a-hello-world-application"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploy-a-hello-world-application"}},[e._v("#")]),e._v(" Deploy a Hello-World Application")]),e._v(" "),t("p",[e._v("Follow the "),t("a",{attrs:{href:"https://argo-cd.readthedocs.io/en/stable/getting_started/#6-create-an-application-from-a-git-repository",target:"_blank",rel:"noopener noreferrer"}},[e._v("official documents"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("h2",{attrs:{id:"advance-configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#advance-configuration"}},[e._v("#")]),e._v(" Advance Configuration")]),e._v(" "),t("h3",{attrs:{id:"artifact-repository-using-minio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#artifact-repository-using-minio"}},[e._v("#")]),e._v(" Artifact Repository Using Minio")]),e._v(" "),t("p",[e._v("In the default deploy using local k8s cluster, MinIO is setuped with 1 instance.")]),e._v(" "),t("p",[e._v("In production, you may want to setup HA for MinIO.")]),e._v(" "),t("p",[e._v("Check "),t("code",[e._v("./cicd/kustomize/minio/production/kustomization.yaml")]),e._v(" for HA MinIO cluster.\n(Simply modify resources field in "),t("code",[e._v("./cicd/kustomize/kustomization")]),e._v(", change the children "),t("code",[e._v("- ./minio/local")]),e._v(" to "),t("code",[e._v("- ./minio/production")]),e._v(")")])])}),[],!1,null,null,null);o.default=r.exports}}]);